asrm.dev {
    encode zstd gzip

    log {
        output stdout
        format console
        level DEBUG
    }

    # Todo lo que venga por /clinicamv ...
    handle_path /clinicamv* {
        # A partir de aquí, la URI ya no tiene /clinicamv.
        # i.e. /clinicamv/api/color-tema -> /api/color-tema

        @api path /api /api/*
        handle @api {
            header { set X-Caddy-Block api }
            root * /var/www/public
            php_fastcgi clinicamv-php:9000   # dejar el fallback a index.php a cargo de Caddy
        }

        # Resto bajo /clinicamv -> Angular
        header { set X-Caddy-Block frontend }
        reverse_proxy clinicamv-frontend:80
    }

    # Estático /presentacion
    handle_path /presentacion* {
        root * /srv/presentacion
        file_server
    }

    # Raíz
    root * /srv/web-personal
    file_server
}
