asrm.dev {
    encode zstd gzip

    log {
        output stdout
        format console
        level DEBUG
    }

    # Trato de ver porque las peticiones caen en frontend y no en php
    # 1) API PRIMERO. Coincide EXACTO y con subrutas.
    handle_path /clinicamv/api* {
        header {
            set X-Caddy-Block api
        }
        root * /var/www/public
        php_fastcgi clinicamv-php:9000
    }

    # 2) Frontend Angular (más general)
    handle_path /clinicamv* {
        header {
            set X-Caddy-Block frontend
        }
        reverse_proxy clinicamv-frontend:80
    }

    # 3) Estático presentación
    handle_path /presentacion* {
        root * /srv/presentacion
        file_server
    }

    # 4) Raíz web personal
    root * /srv/web-personal
    file_server
}


