asrm.dev {
  encode zstd gzip

  # --- API Laravel en /clinicamv/api  (PRIMERO) ---
  # handle_path quita /clinicamv del path, quedando /api/...
  handle_path /clinicamv/api* {
    root * /var/www/public
    php_fastcgi clinicamv-php:9000
  }

  # --- Angular en /clinicamv ---
  # Parche SOLO para assets bajo /clinicamv (evita romper /assets del sitio raíz)
  @ngAssets path /clinicamv/assets*, /clinicamv/*.{js,css,svg,png,jpg,webp,ico,woff,woff2}
  handle @ngAssets {
    uri strip_prefix /clinicamv
    reverse_proxy clinicamv-frontend:80
  }

  # Angular en /clinicamv
  handle_path /clinicamv* {
    reverse_proxy clinicamv-frontend:80
  }

  # --- PRESENTACION estático en /presentacion ---
  handle_path /presentacion* {
    root * /srv/presentacion
    file_server
  }

  # --- WEB PERSONAL raíz ---
  handle {
    root * /srv/web-personal
    file_server
  }
}
