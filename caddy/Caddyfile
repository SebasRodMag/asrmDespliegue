asrm.dev {
    encode zstd gzip

    log {
        output stdout
        format console
        level DEBUG
    }

    # --- API Laravel en /clinicamv/api ---
    route /clinicamv/api/* {
        uri strip_prefix /clinicamv
        root * /var/www/public
        respond /clinicamv/api/_whoami "API BLOCK HIT" 200
        php_fastcgi clinicamv-php:9000
    }

    # --- Angular en /clinicamv ---
    route /clinicamv/* {
        uri strip_prefix /clinicamv
        reverse_proxy clinicamv-frontend:80
    }

    # --- Presentación /presentacion ---
    route /presentacion/* {
        uri strip_prefix /presentacion
        root * /srv/presentacion
        file_server
    }

    # --- Web personal raíz ---
    root * /srv/web-personal
    file_server
}
