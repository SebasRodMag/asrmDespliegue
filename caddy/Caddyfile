asrm.dev {
    log {
        output stdout
        format console
        level DEBUG
    }

    # Todo lo que cuelga de /clinicamv...
    handle_path /clinicamv* {
        # 1) API Laravel: ya entramos sin /clinicamv → la URI aquí es /api/...
        @api path /api*
        handle @api {
            # (Opcional) cabeceras de depuración:
            # header {
            #     set X-Caddy-Block api
            #     set X-Debug-URI {uri}
            # }

            root * /var/www/public
            php_fastcgi clinicamv-php:9000   # fallback automático a /index.php
        }

        # 2) Resto → Angular (catch-all)
        # header { set X-Caddy-Block frontend set X-Debug-URI {uri} }
        reverse_proxy clinicamv-frontend:80
    }

    # Estático /presentacion
    handle_path /presentacion* {
        root * /srv/presentacion
        file_server
    }

    # Raíz
    root * /srv/web-personal
    file_server
}
