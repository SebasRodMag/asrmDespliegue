asrm.dev {
    encode zstd gzip

    log {
        output stdout
        format console
        level DEBUG
    }
    #evitamos route y usamos handle_path para que acorte el prefijo y deja la ruta como /api/...
    # --- API Laravel bajo /clinicamv/api (PRIMERO) ---
    handle_path /clinicamv/api* {
        root * /var/www/public
        php_fastcgi clinicamv-php:9000
    }

    # --- Angular bajo /clinicamv ---
    handle_path /clinicamv* {
        reverse_proxy clinicamv-frontend:80
    }

    # --- Estático /presentacion ---
    handle_path /presentacion* {
        root * /srv/presentacion
        file_server
    }

    # --- Web personal raíz ---
    root * /srv/web-personal
    file_server
}
